function buttonListener(e){e.preventDefault();let t=document.querySelector("#username").value;t?chrome.runtime.sendMessage({message:"login",payload:{username:t}},function(e){if("success"===e)hideError(),loadMainPage();else if("auth"===e)hideError(),loadAuthPage();else if("1041"===e){let t=document.querySelector("#username");t.value="",t.placeholder="Check your login info",t.classList.add("input_err")}else if("1701"===e){let n=document.querySelector("#username");n.value="",n.placeholder="Use auth_code to login",n.classList.add("input_err")}else{let r=document.querySelector("#username");r.value="",r.placeholder="Check your login info",r.classList.add("input_err")}}):document.querySelector("#username").classList.add("input_err")}function loadMainPage(){let e=document.querySelector(".main");document.querySelector(".main form").remove(),document.querySelector(".main #error-message").remove(),e.appendChild(document.createElement("div")).setAttribute("id","settings");let t="";chrome.storage.local.get("user_info",function(e){t=e.user_info;let n=document.querySelector(".title");n.textContent="Welcome back,";let r=document.getElementById("userName");r.innerHTML=t+"!"});var n=e.appendChild(document.createElement("button"));n.setAttribute("class","log_button"),n.type="submit",n.value="Logout",n.innerHTML="LOGOUT",n.addEventListener("click",logout)}function loadAuthPage(){let e=document.querySelector(".main");document.querySelector(".main form").remove();let t="";chrome.storage.local.get("user_info",function(e){t=e.user_info;let n=document.querySelector(".title");n.textContent="Authenticating";let r=document.getElementById("userName");r.innerHTML=t}),showError("Open/Reload play.pixels.xyz and follow instructions.");var n=e.appendChild(document.createElement("button"));n.setAttribute("class","log_button"),n.type="submit",n.value="Logout",n.innerHTML="LOGOUT",n.addEventListener("click",logout)}function loadLoginPage(){let e=document.querySelector(".main");var t=document.querySelector(".main #settings");t&&t.remove();var n=document.querySelector(".main #error-message");n&&n.remove(),document.querySelector(".main .log_button").remove(),document.querySelector(".main #userName").innerHTML="",document.querySelector(".title").innerHTML="Voxels";var r=e.appendChild(document.createElement("form"));r.innerHTML='<input type="text" name="username" id="username" placeholder="Enter username from pixels" required /> <button  class="log_button" type="submit"  value="Login">LOGIN</button>',r.addEventListener("submit",e=>buttonListener(e));var o=e.appendChild(document.createElement("div"));o.id="error-message",o.className="hidden"}function logout(){chrome.runtime.sendMessage({message:"logout"},function(e){"success"===e&&(console.log("Logged out"),loadLoginPage())})}function setStatus(){let e=document.querySelector("#switch_text").innerHTML;chrome.runtime.sendMessage({message:"Active"==e?"extension_deactivate":"extension_activate"},function(e){if("success"===e.message){let t=e.currStatus;t?document.querySelector("#switch_text").innerHTML="Active":document.querySelector("#switch_text").innerHTML="Inactive"}})}function debugLog(e){console.log("Voxels:"),console.log(e)}function showError(e){let t=document.getElementById("error-message");t.textContent=e,t.classList.remove("hidden")}function hideError(){let e=document.getElementById("error-message");e.classList.add("hidden")}document.querySelector("form").addEventListener("submit",e=>buttonListener(e)),document.addEventListener("DOMContentLoaded",function(){chrome.runtime.sendMessage({message:"userStatus"},function(e){if("success"===e.message){let t=e.userStatus,n=e.authStatus;t&&(n?loadMainPage():loadAuthPage())}})});