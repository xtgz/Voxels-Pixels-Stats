let marketPending=!1;function fetchMarketPrices(e){let t=document.querySelectorAll(nodeNames.market_place);if(t.length>0&&!marketPending){let r=[],a=[];t.forEach(e=>{if(!e.classList.contains(nodeNames.market_place_header)){let t=e.querySelector(nodeNames.market_place_name+" span");if(t){let n=t.innerText;r.push(n),a.push(e)}}}),r.length>0&&(marketPending=!0,sendRequestByName(r).then(e=>{addPricesToMarket(e,r,a),marketPending=!1}).catch(e=>{console.error(e),marketPending=!1}))}}async function sendRequestByName(e){return new Promise(async(t,r)=>{chrome.storage.local.get("user_info",async function(a){let n={name:a.user_info,operation:"fetchPricesByName",extra:e};try{let i=await makeFetchRequest(apiURL,n),c=i.data,l=e.map(e=>({name:e,price:c[e]}));t(l)}catch(s){r(s)}})})}function addPricesToMarket(e,t,r){e.forEach(e=>{let a=t.indexOf(e.name),n=r[a];if(null!==e.price){let i=n.querySelector(".voxels-market-create-price");if(i){i.innerText=e.price;let c=document.createElement("img");c.src=chrome.runtime.getURL("images/Prices/coin.png"),i.appendChild(c)}else{let l=n.querySelector(nodeNames.market_place_name);if(l){let s=document.createElement("div");s.classList.add("voxels-market-create-price"),s.innerText=e.price;let m=document.createElement("img");m.src=chrome.runtime.getURL("images/Prices/coin.png"),s.appendChild(m),l.appendChild(s)}}}})}