async function makeFetchRequest(e,t,o="POST"){try{let{userStatus:a,user_acde:r}=await new Promise(e=>{chrome.storage.local.get(["userStatus","user_acde"],function(t){e(t)})});if(!a||!r)return chrome.storage.local.clear(function(){}),"logout";t.user_acde=r,t.version=version;let n=await fetch(e,{method:o,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)});if(200!==n.status)throw Error("fail");let s=await n.json();return s}catch(l){throw console.log(l),l}}function debugLog(e){console.log("Voxels: "),console.log(e)}function handleErrors(e){if(e&&e.data&&e.data.error){switch(e.data.error){case"2001":showAlert("You've already added this location","error");break;case"2003":showAlert("You have to be ingame to add locations.","error");break;case"2006":showAlert("Currently only terravilla and farms can be added. More coming soon!","error");break;case"2007":break;case"2008":showAlert("This farm already exists at this location.","error");break;case"3006":showAlert("You have reached the maximum number of farms.","error");break;case"4006":showAlert("You have reached the maximum number of storages.","error");break;case"7001":showAlert("Too fast.","error");break;case"7002":showAlert("No new transaction found. Please retry in 10s","error");break;case"8001":displayInfo({title:"Update!",rows:[{text:"Voxels has received an update. Please reload this page."}]});break;case"8002":showAlert(e.data.text,"info");break;default:showAlert(e.data.error,"error")}return!0}return!1}function showAlert(e,t){var o=document.querySelector(".voxels-popup");o&&o.remove();var a=document.createElement("div");switch(a.className="voxels-popup",t){case"error":a.innerHTML+="<h3>Voxels Error:</h3><p>"+e+"</p>";break;case"info":a.innerHTML+="<h3>Voxels:</h3><p>"+e+"</p>",a.classList.add("voxels-popup-info");break;case"success":a.innerHTML+="<h3>Voxels:</h3><p>"+e+"</p>",a.classList.add("voxels-popup-success");break;default:a.innerHTML+="<h3>Voxels:</h3><p>"+e+"</p>"}var r=document.createElement("div");r.className="voxels-popup-close",r.innerHTML="X",a.appendChild(r),document.body.appendChild(a),r.addEventListener("click",function(){a.remove()}),setTimeout(function(){a.style.opacity="0",setTimeout(function(){a.remove()},1e3)},5e3)}function quickMessage(e,t){let o=3e3;"news"==t&&(o=6e3);var a=document.querySelector(".voxels-quick-message-popup");a&&a.remove();var r=document.createElement("div");r.className="voxels-quick-message-popup voxels-"+t,r.innerHTML='<p>Voxels:</p><p class="voxels-quick-info">'+e+'</p><div class="voxels-progress-bar"></div>',document.body.appendChild(r),r.querySelector(".voxels-progress-bar").style.animation="voxels-progressBarAnimation "+o/1e3+"s linear forwards",setTimeout(function(){r.style.animation="0.5s ease 0s 1 normal forwards running voxels-slideOut",setTimeout(function(){r.remove()},500)},o)}function convertArrayToObject(e){let t={};return e.forEach((e,o)=>{t[o]=e}),t}function reloadVoxels(){var e=document.querySelector(".voxels-main-container");e&&e.parentNode.removeChild(e),startLoad()}function nFormatter(e,t){let o=[{value:1,symbol:""},{value:1e3,symbol:"K"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}].findLast(t=>e>=t.value);return o?(e/o.value).toFixed(t).replace(/\.0+$|(?<=\.[0-9]*[1-9])0+$/,"").concat(o.symbol):"0"}function loadingScreen(e){let t=document.querySelector("#voxels-main-modal"),o=document.querySelector(".voxels-main"),a=document.createElement("div");if(a.id="voxels-loading-div",a.classList.add("voxels-loading"),1===e)a.innerHTML='<div class="voxels-loader"></div>',o.appendChild(a),t.style.filter="brightness(0.5)";else{let r=document.getElementById("voxels-loading-div");r&&o.removeChild(r),t.style.filter=""}}let dragEl,dragHandleEl,dragging=!1;const lastPosition={};let dragBoundaries;function setupDraggable(){(dragHandleEl=document.querySelector("[data-drag-handle]")).addEventListener("mousedown",dragStart),document.addEventListener("mouseup",dragEnd)}function dragStart(e){0===e.button&&(dragging=!0,(dragEl=getDraggableAncestor(e.target)).style.setProperty("position","absolute"),lastPosition.left=e.target.clientX,lastPosition.top=e.target.clientY,dragHandleEl.classList.add("dragging"),document.addEventListener("mousemove",dragMove))}function dragMove(e){if(1!==e.buttons)return;let t=dragEl.getBoundingClientRect(),o=t.left+e.clientX-lastPosition.left,a=t.top+e.clientY-lastPosition.top,r=window.innerWidth-t.width,n=window.innerHeight-t.height,s=Math.max(0,Math.min(o,r)),l=Math.max(0,Math.min(a,n));dragEl.style.setProperty("left",`${s}px`),dragEl.style.setProperty("top",`${l}px`),lastPosition.left=e.clientX,lastPosition.top=e.clientY,window.getSelection().removeAllRanges(),(0===s||s===r||0===l||l===n)&&0===e.buttons&&dragEnd()}function getDraggableAncestor(e){return e.getAttribute("data-draggable")?e:getDraggableAncestor(e.parentElement)}function dragEnd(){if(dragging){dragHandleEl.classList.remove("dragging"),document.removeEventListener("mousemove",dragMove),dragEl=null,dragging=!1;var e=document.getElementById("voxels-main-modal"),t={};t.top=e.style.top,t.left=e.style.left,chrome.storage.local.set({modalPosition:t})}}function responsiveDraggableReset(){var e=document.getElementById("voxels-main-modal");window.innerWidth>540?(e.style.top="70px",e.style.left="20px"):(e.style.top="50%",e.style.left="50%")}function inputWithCallback(e,t){var o=document.createElement("div");o.className="voxels-popup-input",o.innerHTML="<h3>"+e+'</h3><input type="text" id="inputField"><button id="submitButton">OK</button>',o.classList.add("voxels-popup-info");var a=o.querySelector("#inputField");a.addEventListener("keydown",function(e){document.activeElement===a&&e.stopPropagation()});var r=document.createElement("div");r.className="voxels-popup-close",r.innerHTML="X",o.appendChild(r),document.body.appendChild(o),r.addEventListener("click",function(){o.remove()}),document.getElementById("inputField").focus(),document.getElementById("submitButton").addEventListener("click",function(){var e=document.getElementById("inputField").value.trim();""===e?showAlert("Please enter some input.","error"):(t(e),o.remove())})}function limiter(e,t){let o=0;return function(...a){let r=Date.now();if(r-o>=t)e(...a),o=r;else{let n=Math.round((t-(r-o))/1e3);quickMessage("Please wait "+n+"s...","error")}}}function voxelsConfirm(e,t){var o=document.createElement("div");o.classList.add("voxels-popup-storage","voxels-popup-info"),o.innerHTML="<h3>"+e+'</h3><button id="confirmButton">Yes</button>';var a=document.createElement("div");function r(){o.remove()}a.className="voxels-popup-close",a.innerHTML="X",o.appendChild(a),document.body.appendChild(o),a.addEventListener("click",r),document.getElementById("confirmButton").addEventListener("click",function(){t(!0),r()})}setupDraggable(),window.addEventListener("resize",function(){responsiveDraggableReset()},!0);